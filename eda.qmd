---
title: "Exploratory Data Analysis"
---

Exploratory data analysis (EDA) is an initial data investigation, that [helps to inspect data and figure out what can (and cannot!) be done with data at hand, what trends can be observed and what statistical tests could be used](https://link.springer.com/chapter/10.1007/978-1-4842-2256-0_3#Sec24) (see "Data" section for information on data that we used). 

<center>![Exploratory data analysis borrowed from Cox (2017) paper. URL: https://link.springer.com/chapter/10.1007/978-1-4842-2256-0_3#Sec24](https://user-images.githubusercontent.com/84614994/201210526-3a92cda1-9f16-4f1f-82e2-abec64f1080b.png)</center>

Therefore, this section is dedicated to data exploration! Moreover, in this section we used A LOT of data visualisations. Data visualisation can benefit EDA by [injecting rigour as well as support inferences](https://onlinelibrary.wiley.com/doi/full/10.1111/gean.12338). Actually, [some argue that the sharp distinction between exploratory and explanatory data analyses has started blurring](https://www.annualreviews.org/doi/abs/10.1146/annurev-soc-071312-145551) as the size of datasets keeps increasing.

# What is in our data?

We have discussed the benefits of EDA, but what is in the datasets we have chosen?

Our data can be broadly defined as providing country-level data on climate and individual-level data on attitudes towards climate action and demographic characteristics. Therefore, for the clarity purposes, we will stick to this division for now :)

## Country-level EDA

To answer data questions we created an interactive Shiny dashboard! Our goal is to ensure that not only we understand the data but also those who listen to our data stories. Indeed, interactive data visualisation is a great way to make data (and data science!) more accessible to everyone.

### How has climate change-related country data changed over the years?

In the dashboard below (Figure 1; link in the image label) you can visualise a variety of climate-related data by country over 20 years (2000-2019). For example, if you select Kenya and look at the "ren" (Renewable energy consumption (% of total final energy consumption)) variable, you will see a drop over the years... Why is it a case? And what might have caused this drop? Perhaps there was an increase in total energy consumption, so the reliance on fossil fuels increased?

<center>![Figure 1. Shiny dashboard visualising climate data by country. URL: 6x2oh1-kika0.shinyapps.io/Dashboard](https://user-images.githubusercontent.com/84614994/201220196-22af648f-e9a5-4b1a-9ad4-0a7c5431096a.png)</center>

### Where do countries stand in relation to eahc other?

In the previous subsection we explored climate-related data over time per country. It can show interesting trends, such as decreasing consumption of renewable energy in Kenya. But it might also be worthwhile to explore countries in relation to others. For example, the Shiny Dashboard below (Figure 2; link in the image label) shows CO2 emissions in 2019. China and the United States emerge as two countries releasing the most CO2 emissions with China clearly leading the way. If you look at the CO2 emissions data from 2000 (co2_2000), China and the unites States still stand out but, back them, the US was the main producer of CO2 emissions. What happened during this time? Perhaps this change is a result of [China's economic development](https://www.sciencedirect.com/science/article/pii/S0921800909003164), but does this mean that it is also is the leading country for the consumption of renewable energy in 2019? Alas, no. Interestingly, African countries consume the most renewable energy (see ren_2019 variable).

<center>![Figure 2. Shiny dashboard mapping climate data. URL: 6x2oh1-kika0.shinyapps.io/Dashboard](https://user-images.githubusercontent.com/84614994/201228388-9c17b107-febb-444b-9ee1-33d240248762.png)</center>

## Individual-level EDA

This subsecion will focus on World Values Survey data, which, as we mentioned in the "Data" section provides a representative sample for a number of countries.

```{r}
#| message = F,
#| warning = F,
#| results = F,
#| eval = F
# Load awesomeness
library(tidyverse)
library(sf)
library(here)
library(paletteer)

# Load awesome data 
# If you loaded this data while going through "Data" section then you don't have to load it again!
# We are just aiming to make each section able to stand on its own 
wvs <- read_csv("data/wvs.csv")
geo_df <- st_read("data/climate_action_data.geojson")
osm <- read_csv("result.csv")
```

### Is climate action more important than economic growth?

In the "Introduction" section we mentioned that people tend to agree that climate change is an emergency. We wanted to examine this too. Therefore, we used a question from WVS asking if environmental protection should be prioritised over economic growth as a proxy for peoples attitudes towards climate action. If an individual thinks that environment matters more, then there's a positive attitude, otherwise a negative attitude is held.

Visualisation in Figure 3 supports existing research and, indeed, in the last 20 years people (all countries considered) are more supportive towards climate change. The increase is really evident in the latest survey (Wave 7) which was carried out in 2017-2022.

```{r}
#| message = F,
#| warning = F,
#| results = F,
#| eval = F
# Define cleaning function
sel_mut <- function(df, col, new_col){
  df %>% 
    select(contains(col)) %>% 
    mutate(wave = new_col) %>% 
    rename_with(~str_replace(.x, "[:digit:]", "") %>% str_remove("_"))
}
```


```{r}
#| message = F,
#| warning = F,
#| results = F,
#| eval = F
theme_set(theme_light())
# Explore how responses have changed over time
env_count <- wvs %>% 
  # Select evn columns
  select(contains("env")) %>% 
  #filter(if_any(everything(), is.na)) %>% 
  # Reshape data for easy analysis
  pivot_longer(everything(), names_to = "env", values_to = "opinion") %>% 
#mutate(across(everything()))
  # Drop missing values
  drop_na() %>% 
  mutate(opinion = factor(opinion)) %>% 
  # Count number of respondents in each category
  count(env, opinion) %>% 
  group_by(env) %>% 
  mutate(total = sum(n)) %>% 
  ungroup() %>% 
  mutate(pct = n/total) %>% 
  # Rename rows
  mutate(env = case_when(
    env == "env_4_num" ~ "wave_4",
    env == "env_5_num" ~ "wave_5",
    env == "env_6_num" ~ "wave_6",
    env == "env_7_num" ~ "wave_7"
  ))

# Visualize this
env_count %>% 
  ggplot(mapping = aes(x = env, y = pct*100)) +
  geom_col(aes(fill = opinion), position = "dodge", alpha = 0.8) +
  paletteer::scale_fill_paletteer_d("ggthemes::Tableau_10",
                                    labels=c("protect environment", " Economic growth", "Other")) +
  ggtitle("Protecting environment vs Economic growth") +
  labs(x = "survey period",
       y = "% of respondents in survey") +
  theme(plot.title = element_text(hjust = 0.5))
```

<center>![Figure 3. A graph shows if respondents of all countries consider environmental protection as more important than economic growth](https://user-images.githubusercontent.com/84614994/201218578-4006d110-ab21-4e28-8b79-2bfc19ce19bc.png)</center>

### Age and climate change attitudes

What demographic characteristics might shape attitudes towards the importance to protect environment rather than boost economic growth? We initially [hypothesized that younger individuals are more supportive of climate action rather than older generation](https://www.sciencedirect.com/science/article/pii/S0191886920304943#s0045). Indeed, in Figure 4 we can observe similar trend -- younger individuals prioritise economic protection over economic growth, yet this tends to vary from survey to sruvey, with a notable example of wave 6 conducted right after [economic recession of 2007-2009](https://en.wikipedia.org/wiki/Great_Recession).

```{r}
#| message = F,
#| warning = F,
#| results = F,
#| eval = F
# Reshape data for easier analysis
df <- wvs %>%
  sel_mut(col = "4", new_col = "wave_4") %>% 
  bind_rows(
    sel_mut(wvs, col = "5", new_col = "wave_5")
  ) %>%
  bind_rows(
    sel_mut(wvs, col = "6", new_col = "wave_6")
  ) %>% 
  bind_rows(
    sel_mut(wvs, col = "7", new_col = "wave_7")
  ) %>% 
  rename(env_opinion = env_num) %>% 
  mutate(across(everything(), factor))
```

```{r}
#| message = F,
#| warning = F,
#| results = F,
#| eval = F
df %>% 
  count(wave, env_opinion, age_num) %>% 
  drop_na() %>%
  group_by(age_num, wave) %>% 
  mutate(total = sum(n), pct = n/total) %>%
  ungroup() %>% 
  mutate(age_num = case_when(
    age_num == "1" ~ "16-24",
    age_num == "2" ~ "25-34",
    age_num == "3" ~ "35-44"
  )) %>% 
  ggplot(mapping = aes(x = age_num, y = pct*100)) +
  geom_col(aes(fill = env_opinion), position = "dodge", alpha = 0.8) +
  paletteer::scale_fill_paletteer_d("ggthemes::Tableau_10",
                                    labels=c("protect environment", " Economic growth", "Other")) +
  ggtitle("Protecting environment vs Economic growth") +
  labs(x = "age",
       y = "% of respondents in survey") +
  theme(plot.title = element_text(hjust = 0.5)) +
  facet_wrap(vars(wave), scales = "free_x")
```

<center>![Figure 4. A graph vsualises a relationship between age and support for environmental protection.](https://user-images.githubusercontent.com/84614994/201231114-0f189715-da88-4893-91d5-35bbb4471436.png)</center>

### Income and climate change attitudes

Our previous graph (Figure 4) hinted that perhaps personal and global economic situation has more effects on climate action views than age. Indeed, this is further supported by Figure 5 which shows respondent's income level against economic growth vs environmental support variable. Indeed, in all waves people are more supportive of environmental protection with an exception of respondents with low income in wave 6, which, as it was mentioned, was conducted right after the economic recession.

```{r}
#| message = F,
#| warning = F,
#| results = F,
#| eval = F

# Regroup income levels
df %>% 
  drop_na() %>% 
  mutate(income_num = as.numeric(income_num)) %>% 
  mutate(income = case_when(
    income_num < 4 ~ "low",
    income_num > 7 ~ "high",
    TRUE ~ "middle"
  ),
  
  
  # Account for changes in wave7 encoding
  income = case_when(
    wave == "wave_7" & income_num == 1 ~ "low", 
    wave == "wave_7" & income_num == 2 ~ "middle",
    wave == "wave_7" & income_num == 3 ~ "high",
    TRUE ~ income
  ),
  
  
  income = factor(income, levels = c("high", "middle", "low"))) %>%
  # Count people in a wave sharing same income level and opinion
  count(wave, env_opinion, income) %>% 
  # For people in a wave sharing the same income, what's their total
  group_by(income, wave) %>% 
  # Find how opinion varies among folks sharing the same income 
  mutate(total = sum(n), pct = n/total) %>%
  ungroup() %>% 
  ggplot(mapping = aes(x = income, y = pct*100)) +
  geom_col(aes(fill = env_opinion), position = "dodge", alpha = 0.8) +
  paletteer::scale_fill_paletteer_d("ggthemes::Tableau_10",
                                    labels=c("protect environment", " Economic growth", "Other")) +
  ggtitle("Protecting environment vs Economic growth") +
  labs(x = "income_levels",
       y = "% of respondents in survey") +
  theme(plot.title = element_text(hjust = 0.5)) +
  facet_wrap(vars(wave), scales = "free_x")
  
```

<center>![Figure 5. A graph vsualises a relationship between income and support for environmental protection.](https://user-images.githubusercontent.com/84614994/201231977-ed2d0753-b4a1-4fae-b426-850e583a1dd3.png)</center>



